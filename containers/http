FROM docker.io/library/golang:1.24-bookworm as builder

ARG TARGETPLATFORM

WORKDIR /build

COPY . .

RUN --mount=type=bind,target=/go make setup build

FROM scratch

COPY --from=builder /root/bin/http /http

ENTRYPOINT ["/http"]
